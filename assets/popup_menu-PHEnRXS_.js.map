{"version":3,"file":"popup_menu-PHEnRXS_.js","sources":["../../src/js/header.js","../../src/js/popup_menu.js"],"sourcesContent":["const hamburgerButton = document.querySelector('.hamburger-button');\nconst mobileMenu = document.querySelector('.mobile-menu');\nconst navMenu = document.querySelector('.nav-menu');\nconst closeButton = document.querySelector('.close-button');\nconst toggleLabel = document.querySelector('.toggle-label');\nconst toggleInput = document.querySelector('.toggle');\n\nhamburgerButton.addEventListener('click', () => {\n  mobileMenu.classList.add('show');\n  hamburgerButton.classList.add('.show');\n  navMenu.classList.add('nav-show');\n  toggleLabel.classList.add('toggle-label-show');\n  toggleInput.classList.add('toggle-label-show');\n});\ncloseButton.addEventListener('click', () => {\n  mobileMenu.classList.remove('show');\n  hamburgerButton.classList.remove('.show');\n  navMenu.classList.remove('nav-show');\n  toggleLabel.classList.remove('toggle-label-show');\n  toggleInput.classList.remove('toggle-label-show');\n});\ntoggleInput.addEventListener('change', () => {\n  if (toggleInput.checked) {\n    document.body.setAttribute('data-theme', 'dark');\n    mobileMenu.classList.add('mobile-menu-color');\n  } else {\n    document.body.setAttribute('data-theme', 'light');\n    mobileMenu.classList.remove('mobile-menu-color');\n  }\n});\n","// js/popup_menu.js — popup + favorites\nconst API_ROOT = 'https://tasty-treats-backend.p.goit.global/api';\n\n/* = Helpers = */\nconst qs = (s, p = document) => p.querySelector(s);\nconst qsa = (s, p = document) => [...p.querySelectorAll(s)];\nconst show = el => el && el.classList.remove('hidden');\nconst hide = el => el && el.classList.add('hidden');\nconst esc = s =>\n  (s ?? '').toString().replace(\n    /[&<>\"']/g,\n    m =>\n      ({\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#39;',\n      }[m])\n  );\n// 2 ondalık TRUNC (istemiyorsan toFixed kullanabilirsin)\nfunction format2Trunc(v) {\n  const n = Number.parseFloat(String(v ?? '').replace(',', '.'));\n  if (!Number.isFinite(n)) return '0.00';\n  const t = Math.trunc(n * 100) / 100;\n  return t.toFixed(2);\n}\n\n/* = Sprite (popup yıldızları için) = */\nconst SPRITE_PATH = '../img/icons.svg';\nconst svgIcon = (name, className = '') =>\n  `<svg class=\"icon ${className}\" aria-hidden=\"true\" focusable=\"false\">\n     <use href=\"${SPRITE_PATH}#icon-${name}\"></use>\n   </svg>`;\n\n/* = Favorites (LS) = */\nfunction getFavorites() {\n  try {\n    const v = JSON.parse(localStorage.getItem('favorites'));\n    return Array.isArray(v) ? v : [];\n  } catch {\n    return [];\n  }\n}\nfunction setFavorites(arr) {\n  localStorage.setItem('favorites', JSON.stringify(arr || []));\n}\nconst getIdSafe = o => o?._id || o?.id || o?.recipeId || '';\nconst findIndexById = (list, id) =>\n  (list || []).findIndex(r => String(getIdSafe(r)) === String(id));\nfunction makeFavoritePayload(src) {\n  const id = getIdSafe(src);\n  return {\n    ...src,\n    _id: id,\n    title: src?.title || '',\n    description: src?.description || '',\n    rating: Number(src?.rating) || 0,\n    preview:\n      src?.preview || src?.thumb || src?.image_url || src?.imageUrl || '',\n    category:\n      typeof src?.category === 'string'\n        ? { name: src.category }\n        : src?.category?.name\n        ? src.category\n        : src?.category || {},\n  };\n}\nfunction isFavorite(id) {\n  return findIndexById(getFavorites(), id) !== -1;\n}\n\n/* = Yayıncılar = */\nfunction emitFavoritesSync(id, on) {\n  const ev = new CustomEvent('favorites:sync', {\n    detail: { id: String(id), on: !!on },\n  });\n  window.dispatchEvent(ev);\n  document.dispatchEvent(ev);\n}\nfunction emitFavoritesUpdated() {\n  const ev = new Event('favorites:updated');\n  window.dispatchEvent(ev);\n  document.dispatchEvent(ev);\n}\n\n/* = Toggle = */\nfunction toggleFavoriteById(id, recipeObjForAdd) {\n  const list = getFavorites();\n  const idx = findIndexById(list, id);\n  let nowOn = false;\n\n  if (idx !== -1) {\n    list.splice(idx, 1);\n    nowOn = false;\n  } else {\n    list.unshift(makeFavoritePayload(recipeObjForAdd || { _id: id }));\n    nowOn = true;\n  }\n  // 1) LS yaz\n  setFavorites(list);\n  // 2) İnce taneli: sadece bu kartın kalbini güncelle\n  emitFavoritesSync(id, nowOn);\n  // 3) Geniş: favorites sayfası tam listeyi tazelesin\n  emitFavoritesUpdated();\n\n  return nowOn;\n}\n\n/* = Popup state/refs = */\nlet currentRecipe = null;\nlet currentRating = 0; // ⭐ rating overlay için\nwindow.__currentRecipeId = '';\n\nfunction refs() {\n  return {\n    overlay: qs('#popup-overlay'),\n    content: qs('#popup-content'),\n    pmImage: qs('#pm-image'),\n    pmVideo: qs('#pm-video'),\n    pmIframe: qs('#pm-iframe'),\n    pmTitle: qs('#pm-title'),\n    pmRatingVal: qs('#pm-rating-val'),\n    pmStars: qs('#pm-stars'),\n    pmTime: qs('#pm-time'),\n    pmIngredients: qs('#pm-ingredients'),\n    pmTags: qs('#pm-tags'),\n    pmDesc: qs('#pm-desc'),\n    favBtn: qs('#pm-fav-btn'),\n\n    // ⭐ rating overlay elemanları\n    rateBtn: qs('#pm-rate-btn'),\n    ratingOverlay: qs('#rating-overlay'),\n    ratingStars: qs('#rating-stars'),\n    ratingValueEl: qs('#rating-value'),\n    ratingEmail: qs('#rating-email'),\n    ratingSend: qs('#rating-send'),\n    ratingHint: qs('#rating-hint'),\n  };\n}\n\n/* = Basit yıldız = */\nconst starFilledHTML = `<span class=\"star filled\">${svgIcon('Star')}</span>`;\nconst starEmptyHTML = `<span class=\"star empty\">${svgIcon(\n  'Star-empty'\n)}</span>`;\nfunction renderStaticStars(container, val) {\n  if (!container) return;\n  const n = Number(val) || 0,\n    full = Math.min(5, Math.max(0, Math.floor(n)));\n  container.innerHTML = `<span class=\"star-row\">\n    ${starFilledHTML.repeat(full)}${starEmptyHTML.repeat(5 - full)}\n  </span>`;\n}\n\n/* = Render = */\nfunction renderDetails(recipe) {\n  const r = refs();\n  if (!r.content) return;\n  const id = String(getIdSafe(recipe));\n  if (id) {\n    r.content.dataset.recipeId = id;\n    r.ratingOverlay && (r.ratingOverlay.dataset.recipeId = id); // ⭐ rating overlay id\n    window.__currentRecipeId = id;\n  }\n  r.pmTitle && (r.pmTitle.textContent = recipe.title || 'Untitled');\n  r.pmRatingVal && (r.pmRatingVal.textContent = format2Trunc(recipe.rating));\n  renderStaticStars(r.pmStars, recipe.rating || 0);\n  r.pmTime && (r.pmTime.textContent = recipe.time ? `${recipe.time} min` : '');\n\n  const yt = recipe.youtube || recipe.youtubeUrl || '';\n  if (yt) {\n    r.pmVideo?.classList.remove('hidden');\n    r.pmImage?.classList.add('hidden');\n    const vid = yt.match(/(?:v=|\\/)([0-9A-Za-z_-]{11})(?:\\b|&|$)/)?.[1] || yt;\n    if (r.pmIframe)\n      r.pmIframe.src = `https://www.youtube.com/embed/${vid}?rel=0&modestbranding=1&playsinline=1`;\n  } else {\n    r.pmVideo?.classList.add('hidden');\n    r.pmImage?.classList.remove('hidden');\n    const img =\n      recipe.image_url ||\n      recipe.imageUrl ||\n      recipe.preview ||\n      recipe.thumb ||\n      '';\n    if (r.pmImage)\n      r.pmImage.style.backgroundImage = img ? `url('${esc(img)}')` : '';\n  }\n\n  if (r.pmIngredients) {\n    r.pmIngredients.innerHTML = '';\n    (recipe.ingredients || []).forEach(it => {\n      const name = typeof it === 'string' ? it : it?.name || '';\n      const measure = typeof it === 'string' ? '' : it?.measure || '';\n      const row = document.createElement('div');\n      row.className = 'ing-row';\n      row.innerHTML = `<span class=\"ing-name\">${name}</span><span class=\"ig-measure\">${measure}</span>`;\n      r.pmIngredients.appendChild(row);\n    });\n  }\n\n  if (r.pmTags) {\n    r.pmTags.innerHTML = '';\n    (recipe.tags || []).forEach(tag => {\n      const span = document.createElement('span');\n      span.className = 'tag-chip';\n      span.textContent = `#${tag}`;\n      r.pmTags.appendChild(span);\n    });\n  }\n\n  if (r.pmDesc) r.pmDesc.textContent = recipe.description || '';\n  if (r.favBtn && id)\n    r.favBtn.textContent = isFavorite(id)\n      ? 'Remove to favorite'\n      : 'Add to favorite';\n}\n\nfunction syncFavBtnText() {\n  const r = refs();\n  const id = r.content?.dataset?.recipeId || window.__currentRecipeId || '';\n  if (!r.favBtn || !id) return;\n  r.favBtn.textContent = isFavorite(id)\n    ? 'Remove to favorite'\n    : 'Add to favorite';\n}\n\n/* = Global: openPopup = */\nwindow.openPopup = async function openPopup(recipeOrId) {\n  const r = refs();\n  if (!r.overlay) return;\n  document.documentElement.style.overflow = 'hidden';\n\n  currentRecipe =\n    typeof recipeOrId === 'object' && recipeOrId\n      ? recipeOrId\n      : { _id: String(recipeOrId || '') };\n  renderDetails(currentRecipe);\n  show(r.overlay);\n  syncFavBtnText();\n\n  const id = getIdSafe(currentRecipe);\n  if (!id) return;\n  try {\n    const res = await fetch(`${API_ROOT}/recipes/${encodeURIComponent(id)}`);\n    if (res.ok) {\n      const fresh = await res.json();\n      currentRecipe = { ...currentRecipe, ...fresh };\n      renderDetails(currentRecipe);\n      syncFavBtnText();\n    }\n  } catch {}\n};\n\n/* = Close = */\ndocument.addEventListener('click', e => {\n  const r = refs();\n  if (e.target.closest('.popup-x') || (r.overlay && e.target === r.overlay)) {\n    hide(r.overlay);\n    document.documentElement.style.overflow = '';\n    r.pmIframe && (r.pmIframe.src = '');\n  }\n});\n// Escape: önce rating açıksa onu kapat, değilse popup'ı\nwindow.addEventListener('keydown', e => {\n  if (e.key !== 'Escape') return;\n  const r = refs();\n  if (r.ratingOverlay && !r.ratingOverlay.classList.contains('hidden')) {\n    hide(r.ratingOverlay);\n    return;\n  }\n  hide(r.overlay);\n  document.documentElement.style.overflow = '';\n  r.pmIframe && (r.pmIframe.src = '');\n});\n\n/* = Fav buton = */\ndocument.addEventListener('click', e => {\n  const r = refs();\n  if (!e.target.closest('#pm-fav-btn')) return;\n  const id = r.content?.dataset?.recipeId || window.__currentRecipeId || '';\n  if (!id) return;\n  const on = toggleFavoriteById(id, currentRecipe);\n  r.favBtn &&\n    (r.favBtn.textContent = on ? 'Remove to favorite' : 'Add to favorite');\n});\n\n/* ============ ⭐ Rating overlay ============ */\n// yıldızları temizle/boyama\nfunction clearRatingStars(starsRoot) {\n  if (!starsRoot) return;\n  qsa('svg path', starsRoot).forEach(p => p.setAttribute('fill', '#dcdcdc'));\n}\nfunction paintRatingStars(starsRoot, val) {\n  if (!starsRoot) return;\n  clearRatingStars(starsRoot);\n  const full = Math.floor(val);\n  const half = val % 1 >= 0.5;\n  qsa('.star-container', starsRoot).forEach((c, idx) => {\n    const num = idx + 1;\n    const path = qs('path', c);\n    if (!path) return;\n    if (num <= full) path.setAttribute('fill', '#eea10b');\n    else if (num === full + 1 && half)\n      path.setAttribute('fill', `url(#halfGradient-${num})`);\n  });\n}\nfunction validateRatingForm(r) {\n  const email = r.ratingEmail?.value.trim() || '';\n  const okEmail = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n  const ok = currentRating > 0 && okEmail;\n  if (r.ratingSend) r.ratingSend.disabled = !ok;\n  if (r.ratingHint)\n    r.ratingHint.textContent = ok ? '' : 'Enter valid email and select rating.';\n}\n\n// Aç\ndocument.addEventListener('click', e => {\n  const r = refs();\n  if (e.target.closest('#pm-rate-btn')) {\n    currentRating = 0;\n    r.ratingValueEl && (r.ratingValueEl.textContent = '0.00');\n    r.ratingEmail && (r.ratingEmail.value = '');\n    r.ratingHint && (r.ratingHint.textContent = '');\n    r.ratingSend && (r.ratingSend.disabled = true);\n    clearRatingStars(r.ratingStars);\n    show(r.ratingOverlay);\n    return;\n  }\n  // Kapat\n  if (\n    e.target.closest('#rating-close') ||\n    (r.ratingOverlay && e.target === r.ratingOverlay)\n  ) {\n    hide(r.ratingOverlay);\n  }\n});\n\n// E-posta girildikçe buton aktif/pasif\ndocument.addEventListener('input', e => {\n  const r = refs();\n  if (e.target === r.ratingEmail) validateRatingForm(r);\n});\n\n// Yarım/dolu seçimi\ndocument.addEventListener('click', e => {\n  const r = refs();\n  const halfBtn = e.target.closest('.half-btn');\n  if (!halfBtn || !r.ratingStars?.contains(halfBtn)) return;\n  const val = parseFloat(halfBtn.dataset.val || halfBtn.dataset.value);\n  if (!val) return;\n  currentRating = val;\n  r.ratingValueEl && (r.ratingValueEl.textContent = val.toFixed(2));\n  paintRatingStars(r.ratingStars, val);\n  validateRatingForm(r);\n});\n\n// Gönder\ndocument.addEventListener('click', async e => {\n  const r = refs();\n  if (!e.target.closest('#rating-send')) return;\n  const id =\n    r.ratingOverlay?.dataset?.recipeId || r.content?.dataset?.recipeId || '';\n  if (!id) return;\n  const payload = {\n    rate: currentRating,\n    email: r.ratingEmail?.value.trim() || '',\n  };\n\n  try {\n    r.ratingSend && (r.ratingSend.disabled = true);\n    const res = await fetch(\n      `${API_ROOT}/recipes/${encodeURIComponent(id)}/rating`,\n      {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      }\n    );\n    if (!res.ok) throw new Error('Failed to send rating');\n\n    r.ratingHint && (r.ratingHint.textContent = 'Thanks for rating!');\n    r.ratingHint && r.ratingHint.classList.add('ok');\n\n    // Güncel rating'i çekip popup üstündeki değeri/ikonları güncelle\n    try {\n      const fresh = await fetch(\n        `${API_ROOT}/recipes/${encodeURIComponent(id)}`\n      ).then(x => x.json());\n      r.pmRatingVal &&\n        (r.pmRatingVal.textContent = format2Trunc(fresh?.rating));\n      renderStaticStars(r.pmStars, fresh?.rating ?? 0);\n    } catch {}\n\n    setTimeout(() => hide(r.ratingOverlay), 900);\n  } catch (err) {\n    if (r.ratingHint) {\n      r.ratingHint.textContent = err?.message || 'Error sending rating.';\n      r.ratingHint.classList.remove('ok');\n    }\n  } finally {\n    r.ratingSend && (r.ratingSend.disabled = false);\n  }\n});\n"],"names":["hamburgerButton","mobileMenu","navMenu","closeButton","toggleLabel","toggleInput","API_ROOT","qs","s","p","qsa","show","el","hide","esc","m","format2Trunc","v","n","SPRITE_PATH","svgIcon","name","className","getFavorites","setFavorites","arr","getIdSafe","o","findIndexById","list","id","r","makeFavoritePayload","src","isFavorite","emitFavoritesSync","on","ev","emitFavoritesUpdated","toggleFavoriteById","recipeObjForAdd","idx","nowOn","currentRecipe","currentRating","refs","starFilledHTML","starEmptyHTML","renderStaticStars","container","val","full","renderDetails","recipe","yt","vid","img","it","measure","row","tag","span","syncFavBtnText","recipeOrId","res","fresh","clearRatingStars","starsRoot","paintRatingStars","half","c","num","path","validateRatingForm","email","okEmail","ok","halfBtn","payload","x","err"],"mappings":"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"}