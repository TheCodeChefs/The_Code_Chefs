{"version":3,"file":"favorites.js","sources":["../src/js/favorites-hero.js","../src/js/favorites-filter.js"],"sourcesContent":["// favorites-hero.js — mobilde LS boşsa gizle; değişiklikleri canlı izle\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const container = document.querySelector('.favorites-hero .container');\n  if (!container) return;\n\n  // Mobil tanımı\n  const mqMobile = window.matchMedia('(max-width: 767px)');\n\n  const getFavoritesCount = () => {\n    try {\n      const raw = localStorage.getItem('favorites');\n      const arr = JSON.parse(raw);\n      return Array.isArray(arr) ? arr.length : 0;\n    } catch {\n      return 0;\n    }\n  };\n\n  const buildHero = () => {\n    if (container.querySelector('.f-hero__media')) return; // zaten var\n    const picture = document.createElement('picture');\n\n    // Desktop\n    const sourceDesktop = document.createElement('source');\n    sourceDesktop.media = '(min-width: 1280px)';\n    sourceDesktop.srcset = `\n      ./img/f-hero-desktop@1x.jpg 1x,\n      ./img/f-hero-desktop@2x.jpg 2x\n    `;\n    picture.appendChild(sourceDesktop);\n\n    // Tablet\n    const sourceTablet = document.createElement('source');\n    sourceTablet.media = '(min-width: 768px)';\n    sourceTablet.srcset = `\n      ./img/f-hero-tablet@1x.jpg 1x,\n      ./img/f-hero-tablet@2x.jpg 2x\n    `;\n    picture.appendChild(sourceTablet);\n\n    // Mobile\n    const img = document.createElement('img');\n    img.className = 'f-hero__img';\n    img.src = './img/f-hero-mobile@1x.jpg';\n    img.srcset = `\n      ./img/f-hero-mobile@1x.jpg 1x,\n      ./img/f-hero-mobile@2x.jpg 2x\n    `;\n    img.alt = 'Öne çıkan lezzetli yemek sunumu';\n    img.loading = 'lazy';\n    picture.appendChild(img);\n\n    // Wrapper\n    const mediaWrapper = document.createElement('div');\n    mediaWrapper.className = 'f-hero__media';\n    mediaWrapper.appendChild(picture);\n\n    container.appendChild(mediaWrapper);\n  };\n\n  const destroyHero = () => {\n    const media = container.querySelector('.f-hero__media');\n    if (media) media.remove();\n  };\n\n  const renderHero = () => {\n    const hasFavorites = getFavoritesCount() > 0;\n    const isMobile = mqMobile.matches;\n\n    // SADECE mobilde ve boşken gizle; diğer tüm durumlarda göster\n    if (!hasFavorites && isMobile) {\n      destroyHero();\n    } else {\n      buildHero();\n    }\n  };\n\n  // --- İlk render\n  renderHero();\n\n  // --- Breakpoint değişince yeniden değerlendir\n  mqMobile.addEventListener('change', renderHero);\n\n  // --- Favoriler güncellemeleri (aynı sekmede custom event, farklı sekmede storage)\n  window.addEventListener('favorites:updated', renderHero);\n  window.addEventListener('storage', e => {\n    if (e.key === 'favorites') renderHero();\n  });\n\n  // --- Açılışta veri geç gelirse (async yazımlar için kısa retry)\n  let tries = 0;\n  const maxTries = 12; // ~6 saniye (500ms x 12)\n  const t = setInterval(() => {\n    tries++;\n    renderHero(); // her seferinde koşulu tekrar değerlendir\n    if (getFavoritesCount() > 0 || tries >= maxTries) clearInterval(t);\n  }, 500);\n});\n","// SVG sprite helper\nconst SPRITE_PATH = '../img/icons.svg';\nfunction svgIcon(name, className = '') {\n  return `<svg class=\"icon ${className}\" aria-hidden=\"true\" focusable=\"false\">\n    <use href=\"${SPRITE_PATH}#icon-${name}\"></use>\n  </svg>`;\n}\n\n/* ===== Kategori barını container soluna hizala (eski doğru davranış) ===== */\nfunction alignWithContainer() {\n  const section = document.querySelector('.favorites-filter');\n  const container = section?.querySelector('.container');\n  const wrapper = document.querySelector('.category-wrapper');\n  if (!container || !wrapper) return;\n\n  const vw = window.innerWidth;\n  const cw = container.offsetWidth;\n  const leftSpace = (vw - cw) / 2;\n\n  // tasarımdaki base iç boşluk\n  let extra = 20;\n  if (vw >= 768 && vw < 1280) extra = 32;\n  else if (vw >= 1280) extra = 100;\n\n  wrapper.style.paddingLeft = `${Math.max(0, leftSpace + extra)}px`;\n}\nwindow.addEventListener('load', alignWithContainer);\nwindow.addEventListener('resize', alignWithContainer);\n\n/* ===== Cross-tab publish (index.html & favorites.html arası) ===== */\nconst favBC =\n  'BroadcastChannel' in window ? new BroadcastChannel('favorites') : null;\nfunction broadcastFavoritesChange() {\n  window.dispatchEvent(new Event('favorites:updated'));\n  if (favBC) favBC.postMessage({ type: 'favorites:updated', at: Date.now() });\n  try {\n    if (typeof window.renderAll === 'function') window.renderAll();\n  } catch {}\n}\n\n/* === localStorage helpers */\nfunction getFavoritesLS() {\n  try {\n    const v = JSON.parse(localStorage.getItem('favorites'));\n    return Array.isArray(v) ? v : [];\n  } catch {\n    return [];\n  }\n}\nfunction setFavoritesLS(arr) {\n  localStorage.setItem('favorites', JSON.stringify(arr || []));\n  // Tek yerden yayın\n  broadcastFavoritesChange();\n}\nfunction getRecipeIdSafe(r) {\n  return r?._id || r?.id;\n}\n\nconst esc = s =>\n  (s ?? '').toString().replace(\n    /[&<>\"']/g,\n    m =>\n      ({\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#39;',\n      }[m])\n  );\n\n// === Yıldızlar (boş yıldız eklemez; sadece dolu yıldız sayısı kadar gösterir)\nfunction getStarIcons(rating = 0, { max = 5, fillEmpty = false } = {}) {\n  const full = Math.max(0, Math.min(max, Math.floor(Number(rating) || 0)));\n  const filled = Array.from({ length: full })\n    .map(() => svgIcon('Star', 'star-icon'))\n    .join('');\n\n  if (!fillEmpty) {\n    // 5'e tamamlayan boş/siyah yıldız istenmiyor\n    return filled;\n  }\n\n  const empty = Math.max(0, max - full);\n  const empties = Array.from({ length: empty })\n    .map(() => svgIcon('Star-empty', 'star-icon empty'))\n    .join('');\n\n  return `${filled}${empties}`;\n}\n\n// === Sayfalama yardımcıları\nfunction getRecipesPerPage() {\n  const w = window.innerWidth;\n  if (w < 768) return 9;\n  if (w < 1280) return 12;\n  return 12;\n}\nfunction getPaginationRange(current, total) {\n  if (total <= 2) return [1, total];\n  if (current >= total - 1) return [total - 1, total];\n  if (current <= 1) return [1, 2];\n  return [current, current + 1];\n}\n\n/* ==== State ==== */\nconst state = {\n  currentPage: 1,\n  currentCategory: 'All',\n  recipesPerPage: getRecipesPerPage(),\n  isLoading: false, // LOADING bayrağı\n};\n\nwindow.addEventListener('resize', () => {\n  state.recipesPerPage = getRecipesPerPage();\n  renderAll();\n});\n\nfunction computeCategories(items) {\n  return [\n    ...new Set(\n      (items || []).map(\n        r => r?.category?.name || r?.category || 'Uncategorized'\n      )\n    ),\n  ];\n}\n\n/* ==== DOM refs ==== */\nconst favoritesListEl = document.getElementById('favorites-list');\nconst emptyMessageEl = document.getElementById('empty-message');\nconst categoryListEl = document.getElementById('category-list');\nconst allBtn = document.getElementById('all-categories-btn');\nconst categoryWrapperEl = document.querySelector('.category-wrapper');\n\n// LOADING elemanı (dinamik eklenir)\nlet loadingEl = null;\nfunction ensureLoadingEl() {\n  if (!loadingEl) {\n    loadingEl = document.createElement('div');\n    loadingEl.id = 'loading-message';\n    loadingEl.textContent = 'Loading…';\n    loadingEl.style.textAlign = 'center';\n    loadingEl.style.margin = '24px auto';\n    loadingEl.style.fontWeight = '600';\n    loadingEl.style.opacity = '0.8';\n    favoritesListEl?.insertAdjacentElement('beforebegin', loadingEl);\n  }\n  return loadingEl;\n}\nfunction showLoading() {\n  state.isLoading = true;\n  ensureLoadingEl().style.display = 'block';\n  emptyMessageEl?.classList.add('hidden');\n  const p = getPaginationEl();\n  if (p) p.style.display = 'none';\n  if (favoritesListEl) favoritesListEl.innerHTML = '';\n  // LOADING sırasında kategori çubuğunu da gizle\n  if (categoryWrapperEl) categoryWrapperEl.style.display = 'none';\n}\nfunction hideLoading() {\n  state.isLoading = false;\n  if (loadingEl) loadingEl.style.display = 'none';\n}\n\n// Her zaman mevcut #pagination-container’ı kullan\nfunction getPaginationEl() {\n  let el = document.getElementById('pagination-container');\n  if (!el) {\n    el = document.querySelector('.pagination');\n  }\n  return el;\n}\n\nfunction ensureBaseRefs() {\n  return favoritesListEl && emptyMessageEl && categoryListEl && allBtn;\n}\n\n/* ==== Category buttons ==== */\nfunction renderCategories(items) {\n  if (!ensureBaseRefs()) return;\n\n  // FAVORITES BOŞSA → kategori barını tamamen gizle\n  if (!items || items.length === 0) {\n    if (categoryWrapperEl) categoryWrapperEl.style.display = 'none';\n    categoryListEl.innerHTML = '';\n    // All categories butonunu da pasif bırak\n    if (allBtn) allBtn.classList.remove('active');\n    return;\n  } else {\n    // veri varsa görünür yap\n    if (categoryWrapperEl) categoryWrapperEl.style.display = '';\n  }\n\n  categoryListEl.innerHTML = '';\n\n  const setActiveClasses = () => {\n    document\n      .querySelectorAll('.category')\n      .forEach(b => b.classList.remove('active'));\n    if (state.currentCategory === 'All') allBtn.classList.add('active');\n    else allBtn.classList.remove('active');\n  };\n\n  allBtn.onclick = () => {\n    state.currentCategory = 'All';\n    state.currentPage = 1;\n    setActiveClasses();\n    renderCards();\n  };\n\n  computeCategories(items).forEach(cat => {\n    const btn = document.createElement('button');\n    btn.className = 'category';\n    btn.textContent = cat;\n    if (cat === state.currentCategory) btn.classList.add('active');\n    btn.addEventListener('click', () => {\n      state.currentCategory = cat;\n      state.currentPage = 1;\n      setActiveClasses();\n      btn.classList.add('active');\n      renderCards();\n    });\n    categoryListEl.appendChild(btn);\n  });\n\n  setActiveClasses();\n}\n\n/* ==== Pagination ==== */\nfunction renderPagination(totalPages) {\n  const paginationEl = getPaginationEl();\n  if (!paginationEl) return;\n  paginationEl.innerHTML = '';\n\n  if (!Number.isFinite(totalPages) || totalPages <= 1) {\n    paginationEl.style.display = 'none';\n    return;\n  }\n  paginationEl.style.display = 'flex';\n\n  const iconLeft = isDisabled =>\n    svgIcon(isDisabled ? 'pg-left-icon-gray' : 'pg-left-icon');\n  const iconRight = isDisabled =>\n    svgIcon(isDisabled ? 'pg-right-icon-gray' : 'pg-right-icon');\n\n  const addButton = (\n    label,\n    page,\n    isDisabled = false,\n    className = '',\n    htmlContent = null\n  ) => {\n    const btn = document.createElement('button');\n    btn.className = className;\n    if (htmlContent) btn.innerHTML = htmlContent;\n    else btn.textContent = label;\n    if (isDisabled) btn.disabled = true;\n    if (!isDisabled && page) {\n      btn.addEventListener('click', () => {\n        state.currentPage = page;\n        renderCards();\n      });\n    }\n    paginationEl.appendChild(btn);\n  };\n\n  // <<\n  addButton(\n    '',\n    1,\n    state.currentPage === 1,\n    'page-icon',\n    `<span class=\"double-icon\">${iconLeft(state.currentPage === 1)}${iconLeft(\n      state.currentPage === 1\n    )}</span>`\n  );\n\n  // <\n  addButton(\n    '',\n    state.currentPage - 1,\n    state.currentPage === 1,\n    'page-icon',\n    iconLeft(state.currentPage === 1)\n  );\n\n  const range = getPaginationRange(state.currentPage, totalPages);\n\n  if (range[0] > 1) {\n    const dots = document.createElement('button');\n    dots.textContent = '...';\n    dots.className = 'dots';\n    dots.disabled = true;\n    paginationEl.appendChild(dots);\n  }\n\n  for (let i = range[0]; i <= range[1]; i++) {\n    const btn = document.createElement('button');\n    btn.textContent = i;\n    if (i === state.currentPage) btn.classList.add('active');\n    btn.addEventListener('click', () => {\n      state.currentPage = i;\n      renderCards();\n    });\n    paginationEl.appendChild(btn);\n  }\n\n  if (range[1] < totalPages) {\n    const dots = document.createElement('button');\n    dots.textContent = '...';\n    dots.className = 'dots';\n    dots.disabled = true;\n    paginationEl.appendChild(dots);\n  }\n\n  // >\n  addButton(\n    '',\n    state.currentPage + 1,\n    state.currentPage === totalPages,\n    'page-icon',\n    iconRight(state.currentPage === totalPages)\n  );\n\n  // >>\n  addButton(\n    '',\n    totalPages,\n    state.currentPage === totalPages,\n    'page-icon',\n    `<span class=\"double-icon\">${iconRight(\n      state.currentPage === totalPages\n    )}${iconRight(state.currentPage === totalPages)}</span>`\n  );\n}\n\n/* ==== Cards ==== */\nfunction renderCards() {\n  if (!ensureBaseRefs()) return;\n\n  // LOADING aşamasında liste/pagination manipüle etme\n  if (state.isLoading) {\n    const p = getPaginationEl();\n    if (p) p.style.display = 'none';\n    favoritesListEl.innerHTML = '';\n    emptyMessageEl.classList.add('hidden');\n    return;\n  }\n\n  const favoriteRecipes = getFavoritesLS();\n  const paginationEl = getPaginationEl();\n\n  // Boş liste → mesajı göster, pagination gizle, kategori barını gizle\n  if (!favoriteRecipes || favoriteRecipes.length === 0) {\n    favoritesListEl.innerHTML = '';\n    emptyMessageEl.classList.remove('hidden');\n    if (paginationEl) paginationEl.style.display = 'none';\n    if (categoryWrapperEl) categoryWrapperEl.style.display = 'none';\n    return;\n  }\n  emptyMessageEl.classList.add('hidden');\n\n  // Kategori filtresi\n  const filtered =\n    state.currentCategory === 'All'\n      ? favoriteRecipes\n      : favoriteRecipes.filter(\n          r =>\n            (r?.category?.name || r?.category || 'Uncategorized') ===\n            state.currentCategory\n        );\n\n  if (filtered.length === 0) {\n    favoritesListEl.innerHTML = `<p style=\"text-align:center;\">No recipes in this category.</p>`;\n    if (paginationEl) paginationEl.style.display = 'none';\n    // veri var ama bu kategoride yok → kategori barı görünür kalmalı\n    if (categoryWrapperEl) categoryWrapperEl.style.display = '';\n    return;\n  }\n\n  // Sayfalama\n  const totalPages = Math.max(\n    1,\n    Math.ceil(filtered.length / state.recipesPerPage)\n  );\n  if (state.currentPage > totalPages) state.currentPage = totalPages;\n  const start = (state.currentPage - 1) * state.recipesPerPage;\n  const currentItems = filtered.slice(start, start + state.recipesPerPage);\n\n  // Kartlar\n  favoritesListEl.innerHTML = '';\n  currentItems.forEach(recipe => {\n    const card = document.createElement('div');\n    card.className = 'recipe-card';\n    const bg = recipe.preview || recipe.thumb || recipe.image_url || '';\n    card.style.backgroundImage = bg ? `url('${bg}')` : 'none';\n\n    card.innerHTML = `\n      <div class=\"recipe-overlay\"></div>\n      <div class=\"heart\" data-id=\"${getRecipeIdSafe(recipe) ?? ''}\">\n        ${svgIcon('heart')}\n      </div>\n      <div class=\"recipe-card-content\">\n        <h4>${esc(recipe.title)}</h4>\n        <p>${esc(recipe.description || 'Açıklama bulunamadı.')}</p>\n        <div class=\"recipe-meta\">\n          <span class=\"star-group\">\n            ${Number(recipe.rating ?? 0).toFixed(2)}\n            <span class=\"star-icon\">\n              ${getStarIcons(recipe.rating)} \n            </span>\n          </span>\n          <button class=\"secondary-button see-recipe-btn\">See recipe</button>\n        </div>\n      </div>\n    `;\n\n    // Favorilerden kaldır (kalp)\n    card.querySelector('.heart').addEventListener('click', () => {\n      const rid = String(getRecipeIdSafe(recipe));\n      const all = getFavoritesLS();\n      const idx = all.findIndex(r => String(getRecipeIdSafe(r)) === rid);\n      if (idx !== -1) {\n        all.splice(idx, 1);\n        setFavoritesLS(all); // setFavoritesLS → broadcastFavoritesChange()\n      }\n      // Yeni yayın akışı zaten renderAll tetikliyor\n    });\n\n    // Popup aç\n    card.querySelector('.see-recipe-btn').addEventListener('click', () => {\n      if (typeof window.openPopup === 'function') {\n        window.openPopup(recipe);\n      } else {\n        console.error(\n          '❌ window.openPopup bulunamadı. popup_menu.js yüklendi mi?'\n        );\n      }\n    });\n\n    favoritesListEl.appendChild(card);\n  });\n\n  // veri var → kategori barını görünür yap\n  if (categoryWrapperEl) categoryWrapperEl.style.display = '';\n\n  // pagination’ı sadece 1’den büyükse göster\n  renderPagination(totalPages);\n}\n\n/* ==== Hepsini render eden ==== */\nfunction renderAll() {\n  const items = getFavoritesLS();\n  renderCategories(items); // burada boşsa kategori barı gizlenir\n  renderCards();\n}\n// Popup'tan doğrudan çağrı için global'e bağla\nwindow.renderAll = renderAll;\n\n/* ==== Açılış ==== */\nwindow.addEventListener('load', () => {\n  if (!ensureBaseRefs()) {\n    console.warn('⚠️ Gerekli DOM elemanları bulunamadı.');\n    return;\n  }\n\n  // İlk anda loading göster\n  showLoading();\n  renderCards(); // loading görünürken listeyi temizler (kategori barı da gizli)\n\n  // favorites henüz yazılmamış olabilir (main.js asenkron)\n  let tries = 0;\n  const t = setInterval(() => {\n    const hasData = getFavoritesLS().length > 0;\n    tries++;\n\n    if (hasData || tries > 10) {\n      clearInterval(t);\n      hideLoading();\n      renderAll(); // veri varsa listele, yoksa boş mesaj + kategori gizli\n    }\n  }, 500);\n});\n\n// localStorage başka tab/pencereden veya popup’tan güncellenirse\nwindow.addEventListener('storage', e => {\n  if (e.key === 'favorites') {\n    hideLoading();\n    renderAll();\n  }\n});\nwindow.addEventListener('favorites:updated', () => {\n  hideLoading();\n  renderAll();\n});\n// BroadcastChannel’dan gelen mesajlar\nif (favBC) {\n  favBC.onmessage = ev => {\n    if (ev.data?.type === 'favorites:updated') {\n      hideLoading();\n      renderAll();\n    }\n  };\n}\n"],"names":["container","mqMobile","getFavoritesCount","raw","arr","buildHero","picture","sourceDesktop","sourceTablet","img","mediaWrapper","destroyHero","media","renderHero","hasFavorites","isMobile","e","tries","maxTries","t","SPRITE_PATH","svgIcon","name","className","alignWithContainer","wrapper","vw","cw","leftSpace","extra","favBC","broadcastFavoritesChange","getFavoritesLS","v","setFavoritesLS","getRecipeIdSafe","r","esc","s","m","getStarIcons","rating","max","fillEmpty","full","filled","empty","empties","getRecipesPerPage","w","getPaginationRange","current","total","state","renderAll","computeCategories","items","favoritesListEl","emptyMessageEl","categoryListEl","allBtn","categoryWrapperEl","loadingEl","ensureLoadingEl","showLoading","p","getPaginationEl","hideLoading","el","ensureBaseRefs","renderCategories","setActiveClasses","b","renderCards","cat","btn","renderPagination","totalPages","paginationEl","iconLeft","isDisabled","iconRight","addButton","label","page","htmlContent","range","dots","i","favoriteRecipes","filtered","start","currentItems","recipe","card","bg","rid","all","idx","hasData","ev"],"mappings":"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"}