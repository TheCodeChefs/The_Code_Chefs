import"./assets/popup_menu-PHEnRXS_.js";document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".favorites-hero .container");if(!e)return;const n=window.matchMedia("(max-width: 767px)"),a=()=>{try{const o=localStorage.getItem("favorites"),d=JSON.parse(o);return Array.isArray(d)?d.length:0}catch{return 0}},i=()=>{if(e.querySelector(".f-hero__media"))return;const o=document.createElement("picture"),d=document.createElement("source");d.media="(min-width: 1280px)",d.srcset=`
      ./img/f-hero-desktop@1x.jpg 1x,
      ./img/f-hero-desktop@2x.jpg 2x
    `,o.appendChild(d);const u=document.createElement("source");u.media="(min-width: 768px)",u.srcset=`
      ./img/f-hero-tablet@1x.jpg 1x,
      ./img/f-hero-tablet@2x.jpg 2x
    `,o.appendChild(u);const m=document.createElement("img");m.className="f-hero__img",m.src="./img/f-hero-mobile@1x.jpg",m.srcset=`
      ./img/f-hero-mobile@1x.jpg 1x,
      ./img/f-hero-mobile@2x.jpg 2x
    `,m.alt="Öne çıkan lezzetli yemek sunumu",m.loading="lazy",o.appendChild(m);const M=document.createElement("div");M.className="f-hero__media",M.appendChild(o),e.appendChild(M)},l=()=>{const o=e.querySelector(".f-hero__media");o&&o.remove()},s=()=>{const o=a()>0,d=n.matches;!o&&d?l():i()};s(),n.addEventListener("change",s),window.addEventListener("favorites:updated",s),window.addEventListener("storage",o=>{o.key==="favorites"&&s()});let t=0;const c=12,y=setInterval(()=>{t++,s(),(a()>0||t>=c)&&clearInterval(y)},500)});const N="../img/icons.svg";function E(e,n=""){return`<svg class="icon ${n}" aria-hidden="true" focusable="false">
    <use href="${N}#icon-${e}"></use>
  </svg>`}function $(){const n=document.querySelector(".favorites-filter")?.querySelector(".container"),a=document.querySelector(".category-wrapper");if(!n||!a)return;const i=window.innerWidth,l=n.offsetWidth,s=(i-l)/2;let t=20;i>=768&&i<1280?t=32:i>=1280&&(t=100),a.style.paddingLeft=`${Math.max(0,s+t)}px`}window.addEventListener("load",$);window.addEventListener("resize",$);const x="BroadcastChannel"in window?new BroadcastChannel("favorites"):null;function T(){window.dispatchEvent(new Event("favorites:updated")),x&&x.postMessage({type:"favorites:updated",at:Date.now()});try{typeof window.renderAll=="function"&&window.renderAll()}catch{}}function C(){try{const e=JSON.parse(localStorage.getItem("favorites"));return Array.isArray(e)?e:[]}catch{return[]}}function q(e){localStorage.setItem("favorites",JSON.stringify(e||[])),T()}function A(e){return e?._id||e?.id}const k=e=>(e??"").toString().replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]);function _(e=0,{max:n=5,fillEmpty:a=!1}={}){const i=Math.max(0,Math.min(n,Math.floor(Number(e)||0))),l=Array.from({length:i}).map(()=>E("Star","star-icon")).join("");if(!a)return l;const s=Math.max(0,n-i),t=Array.from({length:s}).map(()=>E("Star-empty","star-icon empty")).join("");return`${l}${t}`}function H(){const e=window.innerWidth;return e<768?9:(e<1280,12)}function j(e,n){return n<=2?[1,n]:e>=n-1?[n-1,n]:e<=1?[1,2]:[e,e+1]}const r={currentPage:1,currentCategory:"All",recipesPerPage:H(),isLoading:!1};window.addEventListener("resize",()=>{r.recipesPerPage=H(),w()});function B(e){return[...new Set((e||[]).map(n=>n?.category?.name||n?.category||"Uncategorized"))]}const p=document.getElementById("favorites-list"),L=document.getElementById("empty-message"),b=document.getElementById("category-list"),h=document.getElementById("all-categories-btn"),f=document.querySelector(".category-wrapper");let g=null;function z(){return g||(g=document.createElement("div"),g.id="loading-message",g.textContent="Loading…",g.style.textAlign="center",g.style.margin="24px auto",g.style.fontWeight="600",g.style.opacity="0.8",p?.insertAdjacentElement("beforebegin",g)),g}function F(){r.isLoading=!0,z().style.display="block",L?.classList.add("hidden");const e=P();e&&(e.style.display="none"),p&&(p.innerHTML=""),f&&(f.style.display="none")}function S(){r.isLoading=!1,g&&(g.style.display="none")}function P(){let e=document.getElementById("pagination-container");return e||(e=document.querySelector(".pagination")),e}function I(){return p&&L&&b&&h}function R(e){if(!I())return;if(!e||e.length===0){f&&(f.style.display="none"),b.innerHTML="",h&&h.classList.remove("active");return}else f&&(f.style.display="");b.innerHTML="";const n=()=>{document.querySelectorAll(".category").forEach(a=>a.classList.remove("active")),r.currentCategory==="All"?h.classList.add("active"):h.classList.remove("active")};h.onclick=()=>{r.currentCategory="All",r.currentPage=1,n(),v()},B(e).forEach(a=>{const i=document.createElement("button");i.className="category",i.textContent=a,a===r.currentCategory&&i.classList.add("active"),i.addEventListener("click",()=>{r.currentCategory=a,r.currentPage=1,n(),i.classList.add("active"),v()}),b.appendChild(i)}),n()}function W(e){const n=P();if(!n)return;if(n.innerHTML="",!Number.isFinite(e)||e<=1){n.style.display="none";return}n.style.display="flex";const a=t=>E(t?"pg-left-icon-gray":"pg-left-icon"),i=t=>E(t?"pg-right-icon-gray":"pg-right-icon"),l=(t,c,y=!1,o="",d=null)=>{const u=document.createElement("button");u.className=o,d?u.innerHTML=d:u.textContent=t,y&&(u.disabled=!0),!y&&c&&u.addEventListener("click",()=>{r.currentPage=c,v()}),n.appendChild(u)};l("",1,r.currentPage===1,"page-icon",`<span class="double-icon">${a(r.currentPage===1)}${a(r.currentPage===1)}</span>`),l("",r.currentPage-1,r.currentPage===1,"page-icon",a(r.currentPage===1));const s=j(r.currentPage,e);if(s[0]>1){const t=document.createElement("button");t.textContent="...",t.className="dots",t.disabled=!0,n.appendChild(t)}for(let t=s[0];t<=s[1];t++){const c=document.createElement("button");c.textContent=t,t===r.currentPage&&c.classList.add("active"),c.addEventListener("click",()=>{r.currentPage=t,v()}),n.appendChild(c)}if(s[1]<e){const t=document.createElement("button");t.textContent="...",t.className="dots",t.disabled=!0,n.appendChild(t)}l("",r.currentPage+1,r.currentPage===e,"page-icon",i(r.currentPage===e)),l("",e,r.currentPage===e,"page-icon",`<span class="double-icon">${i(r.currentPage===e)}${i(r.currentPage===e)}</span>`)}function v(){if(!I())return;if(r.isLoading){const t=P();t&&(t.style.display="none"),p.innerHTML="",L.classList.add("hidden");return}const e=C(),n=P();if(!e||e.length===0){p.innerHTML="",L.classList.remove("hidden"),n&&(n.style.display="none"),f&&(f.style.display="none");return}L.classList.add("hidden");const a=r.currentCategory==="All"?e:e.filter(t=>(t?.category?.name||t?.category||"Uncategorized")===r.currentCategory);if(a.length===0){p.innerHTML='<p style="text-align:center;">No recipes in this category.</p>',n&&(n.style.display="none"),f&&(f.style.display="");return}const i=Math.max(1,Math.ceil(a.length/r.recipesPerPage));r.currentPage>i&&(r.currentPage=i);const l=(r.currentPage-1)*r.recipesPerPage,s=a.slice(l,l+r.recipesPerPage);p.innerHTML="",s.forEach(t=>{const c=document.createElement("div");c.className="recipe-card";const y=t.preview||t.thumb||t.image_url||"";c.style.backgroundImage=y?`url('${y}')`:"none",c.innerHTML=`
      <div class="recipe-overlay"></div>
      <div class="heart" data-id="${A(t)??""}">
        ${E("heart")}
      </div>
      <div class="recipe-card-content">
        <h4>${k(t.title)}</h4>
        <p>${k(t.description||"Açıklama bulunamadı.")}</p>
        <div class="recipe-meta">
          <span class="star-group">
            ${Number(t.rating??0).toFixed(2)}
            <span class="star-icon">
              ${_(t.rating)} 
            </span>
          </span>
          <button class="secondary-button see-recipe-btn">See recipe</button>
        </div>
      </div>
    `,c.querySelector(".heart").addEventListener("click",()=>{const o=String(A(t)),d=C(),u=d.findIndex(m=>String(A(m))===o);u!==-1&&(d.splice(u,1),q(d))}),c.querySelector(".see-recipe-btn").addEventListener("click",()=>{typeof window.openPopup=="function"?window.openPopup(t):console.error("❌ window.openPopup bulunamadı. popup_menu.js yüklendi mi?")}),p.appendChild(c)}),f&&(f.style.display=""),W(i)}function w(){const e=C();R(e),v()}window.renderAll=w;window.addEventListener("load",()=>{if(!I()){console.warn("⚠️ Gerekli DOM elemanları bulunamadı.");return}F(),v();let e=0;const n=setInterval(()=>{const a=C().length>0;e++,(a||e>10)&&(clearInterval(n),S(),w())},500)});window.addEventListener("storage",e=>{e.key==="favorites"&&(S(),w())});window.addEventListener("favorites:updated",()=>{S(),w()});x&&(x.onmessage=e=>{e.data?.type==="favorites:updated"&&(S(),w())});
//# sourceMappingURL=favorites.js.map
